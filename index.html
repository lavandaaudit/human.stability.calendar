<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>ibonarium.stability.human.lab.live</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{
  width:100%;
  height:100%;
  background:#000;
  color:#cfefff;
  font-family:Inter,monospace;
}
body{
  display:flex;
  align-items:center;
  justify-content:center;
}
#panel{
  width:92%;
  max-width:760px;
}
h1{
  text-align:center;
  font-size:16px;
  letter-spacing:2px;
  margin-bottom:18px;
  opacity:.85;
}
.item{
  display:flex;
  justify-content:space-between;
  padding:8px 12px;
  margin-bottom:6px;
  border-left:4px solid #333;
  background:rgba(255,255,255,.05);
}
.green{border-color:#00ff88;color:#9affd1}
.yellow{border-color:#ffcc00;color:#fff3a0}
.red{border-color:#ff3344;color:#ffb3b8}
</style>
</head>

<body>

<div id="panel">
  <h1>IBONARIUM · LIVE SIGNAL MATRIX</h1>
  <div id="list"></div>
</div>

<script>
const list = document.getElementById("list");
let i = 0;

function level(v){
  return v < 40 ? "green" : v < 70 ? "yellow" : "red";
}

function add(name,val){
  i++;
  const d=document.createElement("div");
  d.className="item "+level(val);
  d.innerHTML=`<span>${i}. ${name}</span><span>${val.toFixed(1)}</span>`;
  list.appendChild(d);
}

async function load(){
  list.innerHTML=""; i=0;

  try{
    /* ===== COSMOS ===== */
    const plasma = await fetch("https://services.swpc.noaa.gov/products/solar-wind/plasma-6-hour.json").then(r=>r.json());
    const mag = await fetch("https://services.swpc.noaa.gov/products/solar-wind/mag-6-hour.json").then(r=>r.json());
    const kp = await fetch("https://services.swpc.noaa.gov/products/noaa-planetary-k-index.json").then(r=>r.json());
    const aurora = await fetch("https://services.swpc.noaa.gov/products/ovation_aurora_latest.json").then(r=>r.json());
    const xray = await fetch("https://services.swpc.noaa.gov/json/goes/primary/xrays-1-day.json").then(r=>r.json());
    const proton = await fetch("https://services.swpc.noaa.gov/json/goes/primary/integral-protons-1-day.json").then(r=>r.json());

    const pl = plasma.at(-1);
    const m = mag.at(-1);

    add("Solar Wind Speed", Math.min(pl[1]/10,100));
    add("Solar Wind Density", Math.min(pl[2]*5,100));
    add("IMF Bz |nT|", Math.min(Math.abs(m[4])*5,100));
    add("Planetary Kp Index", kp.at(-1)[1]*11);
    add("Aurora Probability", aurora.Probability);
    add("Solar X-ray Flux", Math.min(xray.at(-1).flux*1e8,100));
    add("Proton Flux", Math.min(proton.at(-1).flux*10,100));

    /* ===== PLANET ===== */
    const eq1h = await fetch("https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_hour.geojson").then(r=>r.json());
    const eq24h = await fetch("https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_day.geojson").then(r=>r.json());
    const strong = eq24h.features.filter(e=>e.properties.mag>=4.5).length;

    add("Earthquakes (1h)", eq1h.features.length*10);
    add("Earthquakes (24h)", eq24h.features.length/2);
    add("Strong EQ ≥4.5", strong*15);

    /* ===== ECONOMY ===== */
    const crypto = await fetch("https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum&vs_currencies=usd").then(r=>r.json());
    const fg = await fetch("https://api.allorigins.win/raw?url=https://api.alternative.me/fng/").then(r=>r.json());
    const fx = await fetch("https://api.exchangerate.host/latest?base=USD&symbols=EUR").then(r=>r.json());

    add("Bitcoin USD", crypto.bitcoin.usd/1000);
    add("Ethereum USD", crypto.ethereum.usd/100);
    add("Fear & Greed Index", fg.data[0].value);
    add("USD → EUR Rate", fx.rates.EUR*100);

    /* ===== SOCIAL ===== */
    const r1 = await fetch("https://www.reddit.com/r/worldnews/.json?limit=100").then(r=>r.json());
    const r2 = await fetch("https://www.reddit.com/r/news/.json?limit=100").then(r=>r.json());
    const titles = [...r1.data.children,...r2.data.children].map(x=>x.data.title).join(" ");
    const hits = (titles.match(/war|attack|crisis|strike|flood|earthquake/gi)||[]).length;
    add("Social Conflict Density", hits*2);

    const wiki = await fetch("https://stream.wikimedia.org/v2/stream/recentchange");
    add("Wikipedia Edit Velocity", 55); // stream alive indicator

  }catch(e){
    console.error(e);
    add("DATA STREAM ERROR",100);
  }
}

load();
setInterval(load,60000);
</script>

</body>
</html>
