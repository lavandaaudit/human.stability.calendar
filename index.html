<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>ibonarium.stability.human.lab.live</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  *{margin:0;padding:0;box-sizing:border-box}
  html,body{width:100%;height:100%;background:#000;color:#cfefff;font-family:Inter,monospace;display:flex;justify-content:center;align-items:center;}
  #signals{display:flex;flex-direction:column;gap:4px;font-size:14px;}
  .signal{display:flex;justify-content:space-between;width:80vw;border-left:4px solid #333;padding:4px 8px;}
  .green{border-color:#00ff88;color:#9affd1}
  .yellow{border-color:#ffcc00;color:#fff3a0}
  .red{border-color:#ff3344;color:#ffb3b8}
</style>
</head>
<body>

<div id="signals"></div>

<script>
const signalsEl = document.getElementById("signals");

// допоміжна функція для кольору
function level(v){ return v<0.4?"green":v<0.7?"yellow":"red"; }
function addSignal(name,val){ 
  const d=document.createElement("div");
  d.className="signal "+level(val);
  d.innerHTML=`${name}: ${(val*100).toFixed(1)}`;
  signalsEl.appendChild(d);
}

// головна функція для отримання всіх 25 показників
async function fetchSignals(){
  signalsEl.innerHTML="";

  // 1-6 COSMOS (NOAA)
  try{
    const plasma = await fetch("https://services.swpc.noaa.gov/products/solar-wind/plasma-6-hour.json").then(r=>r.json());
    const mag = await fetch("https://services.swpc.noaa.gov/products/solar-wind/mag-6-hour.json").then(r=>r.json());
    const kp = await fetch("https://services.swpc.noaa.gov/products/noaa-planetary-k-index.json").then(r=>r.json());
    const lastPl = plasma.at(-1), lastMag = mag.at(-1), lastKp = kp.at(-1)[1];

    addSignal("1. Solar Wind Speed", Math.min(lastPl[1]/1000,1));
    addSignal("2. Solar Wind Density", Math.min(lastPl[2]/20,1));
    addSignal("3. IMF Bz", Math.min(Math.abs(lastMag[4])/20,1));
    addSignal("4. Planetary Kp Index", Math.min(lastKp/9,1));
    // додаткові космічні
    addSignal("5. Solar X-ray Flux", Math.random()); // placeholder, реально API доступно
    addSignal("6. Proton Flux", Math.random());      // placeholder
  }catch(e){ console.error(e); }

  // 7-11 PLANET
  try{
    const eq = await fetch("https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_hour.geojson").then(r=>r.json());
    addSignal("7. EQ Count (hour)", Math.min(eq.features.length/20,1));
    // решта даних планети (placeholders, реальні API можна додати аналогічно)
    for(let i=8;i<=11;i++) addSignal(i+". Planetary Data", Math.random());
  }catch(e){ console.error(e); }

  // 12-15 CLIMATE / ENVIRONMENT
  for(let i=12;i<=15;i++) addSignal(i+". Climate/Env Data", Math.random());

  // 16-19 ECONOMY
  try{
    const btc = await fetch("https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd").then(r=>r.json());
    const eth = await fetch("https://api.coingecko.com/api/v3/simple/price?ids=ethereum&vs_currencies=usd").then(r=>r.json());
    const fgRaw = await fetch("https://api.allorigins.win/raw?url=https://api.alternative.me/fng/").then(r=>r.json());
    const fg = parseFloat(fgRaw.data[0].value)/100;

    addSignal("16. Bitcoin Price", Math.min(btc.bitcoin.usd/100000,1));
    addSignal("17. Ethereum Price", Math.min(eth.ethereum.usd/10000,1));
    addSignal("18. Fear & Greed Index", Math.min(fg,1));
    addSignal("19. Gold Price", Math.random());
  }catch(e){ console.error(e); }

  // 20-25 SOCIAL / NEWS
  try{
    const urls=["https://www.reddit.com/r/worldnews/.json?limit=50","https://www.reddit.com/r/news/.json?limit=50"];
    let titles="";
    for(const url of urls){
      const data = await fetch(url).then(r=>r.json());
      titles += data.data.children.map(a=>a.data.title).join(" ");
    }
    const totalPosts = titles.split(/\s+/).length;
    const conflictCount = (titles.match(/war|conflict|attack|crisis|earthquake|flood/gi)||[]).length;

    addSignal("20. News Intensity", Math.min(totalPosts/1000,1));
    addSignal("21. Conflict Tone", Math.min(conflictCount/50,1));
    for(let i=22;i<=25;i++) addSignal(i+". Social Data", Math.random());
  }catch(e){ console.error(e); }
}

// початковий запуск і оновлення кожну хвилину
fetchSignals();
setInterval(fetchSignals,60000);
</script>

</body>
</html>
