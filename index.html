<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ibonarium Calendar 2026</title>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600&display=swap" rel="stylesheet">
<style>
* {margin:0; padding:0; box-sizing:border-box;}
html,body {width:100%; height:100%; background:#000; color:#cfefff; font-family:'Space Grotesk',sans-serif; overflow:hidden;}
canvas {position:fixed; inset:0; z-index:0;}

.panel {position:relative; z-index:1; max-width:800px; margin:0 auto; text-align:center; padding:20px;}

.date-panel {margin-bottom:20px;}
.date-panel .month-year {font-size:24px; margin-bottom:6px;}
.date-panel .days-since {font-size:16px; opacity:0.6;}

.calendar {display:grid; grid-template-columns:repeat(7,1fr); gap:4px; justify-items:center; margin:10px auto;}
.calendar div {padding:10px 6px; font-size:16px; cursor:pointer; border-radius:4px; transition:0.2s;}
.calendar div:hover {background: rgba(77,210,255,0.2);}
.calendar .today {background:#4dd2ff; color:#000; font-weight:600;}

.holidays {text-align:left; margin-top:10px; font-size:14px; opacity:0.9; max-height:200px; overflow-y:auto;}
.holidays ul {list-style:none; margin-top:6px; padding-left:10px;}
.holidays li {margin-bottom:4px;}

.nav-buttons {margin-bottom:10px;}
.nav-buttons button {padding:6px 12px; margin:0 6px; cursor:pointer; background:#4dd2ff; border:none; color:#000; border-radius:4px; font-weight:600;}
.nav-buttons button:hover {background:#00aaff;}

@media(max-width:600px){
  .calendar div {padding:8px 4px; font-size:14px;}
  .date-panel .month-year {font-size:20px;}
}
</style>
</head>
<body>

<canvas id="stars"></canvas>

<div class="panel">

  <div class="date-panel">
    <div class="month-year" id="monthYear">Loading...</div>
    <div class="days-since" id="daysSince">Calculating...</div>
  </div>

  <div class="nav-buttons">
    <button id="prevMonth">&lt; Назад</button>
    <button id="nextMonth">Вперед &gt;</button>
  </div>

  <div class="calendar" id="calendar"></div>

  <div class="holidays" id="holidays"><ul></ul></div>

</div>

<script>
// ===== STARFIELD =====
const canvas = document.getElementById("stars");
const ctx = canvas.getContext("2d");
let W,H,stars=[];
function resize(){ W=canvas.width=window.innerWidth; H=canvas.height=window.innerHeight; stars=Array.from({length:160},()=>({x:Math.random()*W, y:Math.random()*H, z:Math.random()*W})); }
resize(); window.addEventListener("resize",resize);
function render(){ctx.fillStyle="#000"; ctx.fillRect(0,0,W,H); ctx.fillStyle="#4dd2ff";
  for(let s of stars){ s.z-=0.25; if(s.z<=0)s.z=W; const k=128/s.z, x=(s.x-W/2)*k+W/2, y=(s.y-H/2)*k+H/2;
  if(x>0&&x<W&&y>0&&y<H){ const size=(1-s.z/W)*2; ctx.fillRect(x,y,size,size);} } requestAnimationFrame(render);}
render();

// ===== DAYS SINCE 1 AD =====
const daysEl = document.getElementById("daysSince");
function updateDaysSince(){ const today=new Date(); const start=new Date(1,0,1); const diff=today-start; const days=Math.floor(diff/(1000*60*60*24));
daysEl.textContent=`Днів від Нової Ери: ${days}`;}
updateDaysSince();

// ===== CALENDAR =====
const calendarEl = document.getElementById("calendar");
const monthYearEl = document.getElementById("monthYear");
let currentMonth = new Date().getMonth();
const year = 2026;
const months = ["Січень","Лютий","Березень","Квітень","Травень","Червень","Липень","Серпень","Вересень","Жовтень","Листопад","Грудень"];

function drawMonth(month){
  calendarEl.innerHTML="";
  monthYearEl.textContent=`${months[month]} ${year}`;
  const firstDay = new Date(year,month,1).getDay();
  const daysInMonth = new Date(year,month+1,0).getDate();
  for(let i=0;i<firstDay;i++) calendarEl.appendChild(document.createElement("div"));
  for(let d=1;d<=daysInMonth;d++){
    const div=document.createElement("div");
    div.textContent=d;
    const dateStr=`${year}-${String(month+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
    if(dateStr===new Date().toISOString().split('T')[0]) div.classList.add("today");
    div.addEventListener("click",()=>showHolidays(dateStr));
    calendarEl.appendChild(div);
  }
}

const holidaysEl = document.getElementById("holidays");
async function showHolidays(dateStr){
  holidaysEl.innerHTML="<ul></ul>";
  const ul = holidaysEl.querySelector("ul");
  try{
    const res = await fetch(`http://localhost:3000/holidays/${dateStr}`);
    const data = await res.json();
    data.holidays.forEach(h=>{
      const li=document.createElement("li"); li.textContent=h; ul.appendChild(li);
    });
  } catch(e){ console.error("Fetch holidays error:", e); ul.innerHTML="<li>Не вдалося підвантажити свята</li>"; }
}

// ===== NAVIGATION =====
document.getElementById("prevMonth").addEventListener("click",()=>{
  currentMonth=(currentMonth+11)%12; drawMonth(currentMonth);
  showHolidays(`${year}-${String(currentMonth+1).padStart(2,'0')}-01`);
});
document.getElementById("nextMonth").addEventListener("click",()=>{
  currentMonth=(currentMonth+1)%12; drawMonth(currentMonth);
  showHolidays(`${year}-${String(currentMonth+1).padStart(2,'0')}-01`);
});

// ===== INIT =====
drawMonth(currentMonth);
const today=new Date();
const todayStr=`${year}-${String(today.getMonth()+1).padStart(2,'0')}-${String(today.getDate()).padStart(2,'0')}`;
showHolidays(todayStr);
</script>

</body>
</html>
