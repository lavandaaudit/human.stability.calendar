<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ibonarium Calendar 2026</title>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600&display=swap" rel="stylesheet">
<style>
* {margin:0; padding:0; box-sizing:border-box;}
html,body {width:100%; height:100%; background:#000; color:#cfefff; font-family:'Space Grotesk',sans-serif; overflow:hidden;}
canvas {position:fixed; inset:0; z-index:0;}

.panel {position:relative; z-index:1; max-width:800px; margin:0 auto; text-align:center; padding:20px;}

.date-panel {margin-bottom:20px;}
.date-panel .today {font-size:28px; line-height:1.2;}
.date-panel .days-since {font-size:16px; opacity:0.6; margin-top:6px;}

.calendar {display:grid; grid-template-columns:repeat(7,1fr); gap:4px; justify-items:center; margin:0 auto 20px;}
.calendar div {padding:10px 6px; font-size:16px; cursor:pointer; border-radius:4px; transition:0.2s;}
.calendar div:hover {background: rgba(77,210,255,0.2);}
.calendar .today {background:#4dd2ff; color:#000; font-weight:600;}

.month-label {grid-column:1/-1; font-weight:600; font-size:18px; margin:8px 0;}

.holidays {text-align:left; margin-top:10px; font-size:14px; opacity:0.9; max-height:200px; overflow-y:auto;}
.holidays ul {list-style:none; margin-top:6px; padding-left:10px;}
.holidays li {margin-bottom:4px;}

@media(max-width:600px){
  .calendar div {padding:8px 4px; font-size:14px;}
  .date-panel .today {font-size:22px;}
}
</style>
</head>
<body>

<canvas id="stars"></canvas>

<div class="panel">

  <div class="date-panel">
    <div class="today" id="today">Loading...</div>
    <div class="days-since" id="daysSince">Calculating...</div>
  </div>

  <div class="calendar" id="calendar"></div>

  <div class="holidays" id="holidays"><ul></ul></div>

</div>

<script>
// ===== OFF-GRID STARFIELD =====
const canvas = document.getElementById("stars");
const ctx = canvas.getContext("2d");
let W,H,stars=[];
function resize(){ W=canvas.width=window.innerWidth; H=canvas.height=window.innerHeight; stars=Array.from({length:160},()=>({x:Math.random()*W, y:Math.random()*H, z:Math.random()*W})); }
resize(); window.addEventListener("resize",resize);
function render(){
  ctx.fillStyle="#000"; ctx.fillRect(0,0,W,H); ctx.fillStyle="#4dd2ff";
  for(let s of stars){
    s.z-=0.25; if(s.z<=0)s.z=W;
    const k=128/s.z, x=(s.x-W/2)*k+W/2, y=(s.y-H/2)*k+H/2;
    if(x>0&&x<W&&y>0&&y<H){ const size=(1-s.z/W)*2; ctx.fillRect(x,y,size,size);}
  }
  requestAnimationFrame(render);
}
render();

// ===== DATE & DAYS SINCE 1 AD =====
const todayEl = document.getElementById("today");
const daysEl = document.getElementById("daysSince");
function updateDate(){
  const today = new Date();
  todayEl.textContent = today.toLocaleDateString('uk-UA',{weekday:'long', year:'numeric', month:'long', day:'numeric'});
  const start = new Date(1,0,1);
  const diff = today - start;
  const days = Math.floor(diff / (1000*60*60*24));
  daysEl.textContent = `Днів від Нової Ери: ${days}`;
}
updateDate();

// ===== CALENDAR 2026 =====
const calendarEl = document.getElementById("calendar");
const months = ["Січень","Лютий","Березень","Квітень","Травень","Червень","Липень","Серпень","Вересень","Жовтень","Листопад","Грудень"];

let holidaysData = {}; // тут будемо зберігати динамічно підвантажені свята

async function fetchHolidays(){
  const url = 'https://date.nager.at/api/v3/PublicHolidays/2026/UA';
  try{
    const res = await fetch(url);
    const data = await res.json();
    data.forEach(item=>{
      holidaysData[item.date] = [item.localName, item.name];
    });
  }catch(e){
    console.error("Помилка підвантаження свят:", e);
  }
}

function drawCalendar(year){
  calendarEl.innerHTML="";
  for(let m=0;m<12;m++){
    const monthLabel = document.createElement("div");
    monthLabel.classList.add("month-label");
    monthLabel.textContent = months[m];
    calendarEl.appendChild(monthLabel);

    const firstDay = new Date(year,m,1).getDay(); // 0=неділя
    const daysInMonth = new Date(year,m+1,0).getDate();

    for(let i=0;i<firstDay;i++){ const div=document.createElement("div"); calendarEl.appendChild(div); }

    for(let d=1;d<=daysInMonth;d++){
      const div = document.createElement("div");
      div.textContent=d;
      const dateStr = `${year}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
      if(dateStr===new Date().toISOString().split('T')[0]) div.classList.add("today");
      div.addEventListener("click",()=>showHolidays(dateStr));
      calendarEl.appendChild(div);
    }
  }
}

// ===== SHOW HOLIDAYS =====
const holidaysEl = document.getElementById("holidays");
function showHolidays(dateStr){
  holidaysEl.innerHTML="<ul></ul>";
  const ul = holidaysEl.querySelector("ul");
  if(holidaysData[dateStr]){
    holidaysData[dateStr].forEach(h=>{
      const li=document.createElement("li");
      li.textContent=h;
      ul.appendChild(li);
    });
  } else {
    const li=document.createElement("li");
    li.textContent="Свят цього дня немає";
    ul.appendChild(li);
  }
}

// ===== INIT =====
async function init(){
  await fetchHolidays();
  drawCalendar(2026);
  showHolidays(new Date().toISOString().split('T')[0]);
}
init();
</script>
</body>
</html>
